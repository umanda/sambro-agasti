<?php/** ** Library functions for implementation independant messaging for SMS* Main messaging controller functions with modular plugin architecture irrespective of the SMS Gateway application * * * PHP version 4 and 5 * * LICENSE: This source file is subject to LGPL license * that is available through the world-wide-web at the following URI: * http://www.gnu.org/copyleft/lesser.html * * @package    framework * @subpackage messaging * @author     Ajay Kumar <ajuonline at gmail dot com><aj at mindtakers dot com> * @copyright  Lanka Software Foundation - http://www.opensource.lk * @version    $Id: lib_sms_main.inc,v 1.2 2008/09/15 13:50:20 franboon Exp $ * @license    http://www.gnu.org/copyleft/lesser.html GNU Lesser General Public License (LGPL) * */global $global;require_once $global['approot']."/mod/msg/lib_sms_keywords.inc";require_once $global['approot']."/mod/msg/lib_sms_errors.inc";require_once $global['approot']."/mod/msg/lib_sms_handler.inc";
global $sender_phone_number;global $sms_sent_timestamp;global $sms_message;
function shn_msg_push_to_sms_handler($received_message){    global $global;    $sender_phone_number = $received_message['sender'];    $sms_sent_timestamp = $received_message['received'];    $sms_message = $received_message['message'];    //echo "<br \>SMS Sent to main SMS Handler. <br \>From: ".$sender_phone_number;    //shn_msg_sms_authenticate($received_message); add authentication function here    // if authenticated check keyword    $parsed_sms = _shn_msg_parse_short_message($sms_message);    //echo "<br \> SMS Text = ".$sms_message;    //echo "<br \> Keyword Text = ".$parsed_sms[0];    //check for valid keyword    $keyword_check_result = _shn_msg_sms_keyword_check($parsed_sms[0], $sender_phone_number);    if($keyword_check_result!=0){        if($keyword_check_result['type'] == 'number'){            //execute_number_menu_function($parsed_sms);            //echo "<br \>Key word is Valid and number";            _shn_msg_sms_action($parsed_sms, $sender_phone_number);        }        elseif($keyword_check_result['type'] == 'word'){            //execute_word_menu_function($parsed_sms);            //echo "<br \>Key word is Valid and WORD <br \>";           _shn_msg_sms_action($parsed_sms, $sender_phone_number);        }        else{            //error already sent echo " Keywords is in invalid format";//impossible tho            exit;        }    }    else{        //error already sent echo " Keyword does not exists in LIST";        exit;    }}?>